<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">

<title>Template</title>

<script type="text/javascript">
// Frame buster
if(top !== self) {
  top.location.replace(self.location.href);
}
</script>

<script type="text/javascript" src="three.min.js"></script>
<script type="text/javascript" src="three.Densaugeo.js"></script>

<style type='text/css'>
.canvas {
  position: absolute;
  top:      0px;
  left:     0px;
  z-index:  0;
  width:    100%;
  height:   100%;
  border:   none;
}
</style>
</head>

<body>

</body>

<script type="text/javascript">

////////////////////
// three.js setup //
////////////////////

var scene = new THREE.Scene();

var camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 1, 100);
camera.matrix.compose(new THREE.Vector3(0, 0, 10), new THREE.Quaternion(0, 0, -1, 0), new THREE.Vector3(1, 1, 1));
scene.add(camera);

var controls = new THREE.Densaugeo.FreeControls(camera);

var ambientLight = new THREE.AmbientLight(0x3F3F3F);
scene.add(ambientLight);

// Sunlight
var directionalLight = new THREE.DirectionalLight(0xA0A0A0);
directionalLight.position.set(-7.1, 2.75, 10);
scene.add(directionalLight);

var loader = new THREE.Densaugeo.JSONMultiLoader();

var renderer = new THREE.WebGLRenderer();
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.setClearColor(0xC0C0C0, 1);

document.body.appendChild(renderer.domElement);
renderer.domElement.className += " canvas";

// WebGL occupies entire browser window
window.addEventListener("resize", function()
{
  camera.aspect = window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  
  renderer.setSize(window.innerWidth, window.innerHeight);
});

///////////////
// WebSocket //
///////////////

var ws =  new WebSocket('ws://' + window.location.host);

ws.onmessage = function(e) {
  console.log('Received message: ' + e.data);
  console.log(e);
}

/////////////////////
// Startup scripts //
/////////////////////

eval(localStorage.onstart);

</script>
</html>
